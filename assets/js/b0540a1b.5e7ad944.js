"use strict";(self.webpackChunkmy_notes=self.webpackChunkmy_notes||[]).push([[370],{3997:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});const c=JSON.parse('{"id":"\u06a9\u062a\u0627\u0628 \u0647\u0627/Concurrency_in_GO","title":"Concurrency in GO","description":"\u0628\u0631\u062f\u0627\u0634\u062a \u0647\u0627\u06cc \u0645\u0646 \u0627\u0632 \u06a9\u062a\u0627\u0628 \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u062f\u0631 \u06af\u0648","source":"@site/docs/\u06a9\u062a\u0627\u0628 \u0647\u0627/Concurrency_in_GO.md","sourceDirName":"\u06a9\u062a\u0627\u0628 \u0647\u0627","slug":"/\u06a9\u062a\u0627\u0628 \u0647\u0627/Concurrency_in_GO","permalink":"/my-notes/docs/\u06a9\u062a\u0627\u0628 \u0647\u0627/Concurrency_in_GO","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"book","permalink":"/my-notes/docs/tags/book"},{"inline":true,"label":"go","permalink":"/my-notes/docs/tags/go"}],"version":"current","lastUpdatedBy":"mahdi momeni","lastUpdatedAt":1755924828000,"frontMatter":{"title":"Concurrency in GO","tags":["book","go"],"description":"\u0628\u0631\u062f\u0627\u0634\u062a \u0647\u0627\u06cc \u0645\u0646 \u0627\u0632 \u06a9\u062a\u0627\u0628 \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u062f\u0631 \u06af\u0648"},"sidebar":"tutorialSidebar","previous":{"title":"\u0645\u0642\u062f\u0645\u0647","permalink":"/my-notes/docs/\u06a9\u062a\u0627\u0628 \u0647\u0627/intro"},"next":{"title":"Docker In Action","permalink":"/my-notes/docs/\u06a9\u062a\u0627\u0628 \u0647\u0627/docker_in_action"}}');var s=r(4848),i=r(8453);const o={title:"Concurrency in GO",tags:["book","go"],description:"\u0628\u0631\u062f\u0627\u0634\u062a \u0647\u0627\u06cc \u0645\u0646 \u0627\u0632 \u06a9\u062a\u0627\u0628 \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u062f\u0631 \u06af\u0648"},t=void 0,l={},d=[{value:"1. An introduction to Concurrency",id:"1-an-introduction-to-concurrency",level:2},{value:"Race Condition",id:"race-condition",level:3},{value:"Atomicity",id:"atomicity",level:3},{value:"Memory Access Synchronization",id:"memory-access-synchronization",level:3},{value:"DeadLock",id:"deadlock",level:3},{value:"Livelock",id:"livelock",level:3},{value:"Starvation",id:"starvation",level:3},{value:"2. Modeling your Code: Communicating Sequentional Process",id:"2-modeling-your-code-communicating-sequentional-process",level:2},{value:"3. Go&#39;s Concurrency Building Blocks",id:"3-gos-concurrency-building-blocks",level:2},{value:"goroutine",id:"goroutine",level:3},{value:"Fork-join Model",id:"fork-join-model",level:4},{value:"Mutex and RWMutex",id:"mutex-and-rwmutex",level:4},{value:"Cond",id:"cond",level:4},{value:"Once",id:"once",level:4},{value:"Pool",id:"pool",level:4},{value:"4. Concurrency patterns in Go",id:"4-concurrency-patterns-in-go",level:2},{value:"\u0646\u06a9\u0627\u062a \u062a\u06a9\u0645\u06cc\u0644\u06cc \u0648 Best Practices",id:"\u0646\u06a9\u0627\u062a-\u062a\u06a9\u0645\u06cc\u0644\u06cc-\u0648-best-practices",level:2},{value:"5. Concurrency at Scale",id:"5-concurrency-at-scale",level:2},{value:"6. Goroutines and the Go runtime",id:"6-goroutines-and-the-go-runtime",level:2}];function a(n){const e={admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:"https://m.media-amazon.com/images/I/91boXuKgKSL._SL1500_.jpg",height:"500"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0646\u0627\u0645 \u06a9\u062a\u0627\u0628"}),": \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u062f\u0631 \u06af\u0648"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0648\u06cc\u0631\u0627\u06cc\u0634:"})," \u0627\u0648\u0644"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0633\u0627\u0644 \u0686\u0627\u067e"}),":\u06f1\u06f3\u06f9\u06f7"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0633\u0627\u0644 \u062e\u0648\u0646\u062f\u0646 \u0645\u0646"}),": \u06f1\u06f4\u06f0\u06f4 \u062a\u0627\u0628\u0633\u062a\u0627\u0646"]}),"\n",(0,s.jsx)(e.h2,{id:"1-an-introduction-to-concurrency",children:"1. An introduction to Concurrency"}),"\n",(0,s.jsx)(e.p,{children:"\u0686\u0631\u0627 \u0627\u0635\u0644\u0627 \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u0633\u062e\u062a\u0647 \u0686\u0648\u0646 \u0645\u0639\u0645\u0648\u0644\u0627 \u063a\u06cc\u0631 \u0642\u0627\u0628\u0644 \u067e\u06cc\u0634 \u0628\u06cc\u0646\u06cc \u0647\u0633\u062a\u06cc \u0648  \u067e\u06cc\u062f\u0627 \u06a9\u0631\u062f\u0646 \u0645\u0634\u06a9\u0644 \u0633\u062e\u062a. \u0641\u06a9\u0631 \u06a9\u0646 \u0634\u0645\u0627 \u06cc\u0647 \u06a9\u062f \u0627\u0633\u06cc\u0646\u06a9\u06cc \u0646\u0648\u0634\u062a\u06cc \u06a9\u0647 \u062f\u0631\u0633\u062a \u06a9\u0627\u0631 \u0645\u06cc\u06a9\u0646\u0647 \u0648\u0644\u06cc \u0628\u0639\u062f \u06f5 \u0633\u0627\u0644 \u06cc\u0647 \u062a\u0633\u06a9 \u062f\u0631 \u067e\u0633 \u0648 \u067e\u06cc\u0634 \u0627\u0648\u0646 \u06a9\u062f\u0647 \u0627\u0636\u0627\u0641\u0647 \u0645\u06cc\u0634\u0647 \u06a9\u0647 \u0628\u0627\u0639\u062b \u062a\u0631\u06a9\u06cc\u062f\u0646 \u06a9\u062f \u0642\u0628\u0644\u06cc \u0645\u06cc\u0634\u0647"}),"\n",(0,s.jsx)(e.h3,{id:"race-condition",children:"Race Condition"}),"\n",(0,s.jsx)(e.p,{children:"\u06a9\u0644\u0627 \u0627\u06cc\u0646 \u067e\u062f\u06cc\u062f\u0647 \u0632\u0645\u0627\u0646\u06cc \u0627\u062a\u0641\u0627\u0642 \u0645\u06cc\u0641\u062a\u0647 \u06a9\u0647 \u062f\u0648 \u06cc\u0627 \u0686\u0646\u062f \u0639\u0645\u0644\u06cc\u0627\u062a \u0628\u0627\u06cc\u062f \u062a\u0648\u06cc \u062a\u0631\u062a\u06cc\u0628 \u062f\u0631\u0633\u062a \u0627\u062c\u0631\u0627 \u0634\u0646 \u06a9\u0647 \u0628\u0631\u0646\u0627\u0645\u0647 \u062f\u0631\u0633\u062a \u06a9\u0627\u0631 \u06a9\u0646\u0647 \u0648\u0644\u06cc \u0627\u06cc\u0646 \u0634\u0631\u0627\u06cc\u0637 \u0648 \u062a\u0631\u062a\u06cc\u0628 \u0647\u0645\u06cc\u0634\u0647 \u06af\u0627\u0631\u0627\u0646\u062a\u06cc \u0646\u0645\u06cc\u0634\u0646. \u0645\u062b\u0644\u0627 \u06a9\u062f \u0632\u06cc\u0631:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:'var data int\n\ngo func() {\n data++ // 1\n}()\n\nif data == 0 { // 2\nfmt.printf("the value is %v \\n", data) // 3\n}\n\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u0633\u0647 \u062a\u0627 \u062d\u0627\u0644\u062a \u062f\u0627\u0631\u0647"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u0627\u0648\u0644 \u06f2 \u0627\u062c\u0631\u0627 \u0645\u06cc\u0634\u0647 \u0628\u0639\u062f \u06f3 \u0648 \u0628\u0639\u062f \u06f1"}),"\n",(0,s.jsx)(e.li,{children:"\u0627\u0648\u0644 \u06f1 \u0627\u062c\u0631\u0627 \u0645\u06cc\u0634\u0647 \u0628\u0639\u062f \u06f2 \u0648 \u0628\u0639\u062f \u06f3"}),"\n",(0,s.jsx)(e.li,{children:"\u0627\u0648\u0644 \u06f2 \u0627\u062c\u0631\u0627 \u0645\u06cc\u0634\u0647 \u0628\u0639\u062f \u06f1 \u0648 \u0628\u0639\u062f \u06f3\n\u062f\u0642\u06cc\u0642\u0627 \u0645\u0634\u06a9\u0644 \u06a9\u062f \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u062a \u0647\u0645\u06cc\u0646\u0647 \u0645\u0648\u0642\u0639 \u0646\u0648\u0634\u062a\u0646 \u06a9\u062f \u0628\u0627\u06cc\u062f \u0647\u0645\u0647 \u0633\u0646\u0627\u0631\u06cc\u0648 \u0647\u0627\u06cc \u0644\u0627\u0632\u0645 \u062f\u0631 \u0646\u0638\u0631 \u0628\u06af\u06cc\u0631\u06cc\u0645. \u062d\u0627\u0644\u0627 \u0627\u06af\u0647 \u0628\u06cc\u0627\u06cc\u0645 \u0627\u06cc\u0646 \u06a9\u0627\u0631 \u0631\u0648 \u0628\u06a9\u0646\u06cc\u0645 \u0686\u06cc:"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:'var data int\n\ngo func() {\n data++ // 1\n}()\n\ntime.sleep(1*time.second)\n\nif data == 0 { // 2\nfmt.printf("the value is %v \\n", data) // 3\n}\n\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u0645\u0627 \u0628\u0627 \u062a\u0627\u062e\u06cc\u0631\u06cc \u06a9\u0647 \u0627\u0636\u0627\u0641\u0647 \u06a9\u0631\u062f\u06cc\u0645 \u0641\u0642\u0637 \u0627\u062d\u062a\u0645\u0627\u0644 \u0648\u0642\u0648\u0639 \u0631\u0648 \u06a9\u0645 \u06a9\u0631\u062f\u06cc\u0645 \u0648\u0644\u06cc \u0645\u0634\u06a9\u0644 \u0647\u0645\u0686\u0646\u0627\u0646 \u0647\u0633\u062a"}),"\n",(0,s.jsx)(e.h3,{id:"atomicity",children:"Atomicity"}),"\n",(0,s.jsxs)(e.p,{children:["\u0648\u0642\u062a\u06cc \u0645\u06cc\u06af\u06cc\u0645 \u06cc\u0647 \u0686\u06cc\u0632\u06cc \u0627\u062a\u0645\u06cc\u06a9 \u0647\u0633\u062a\u0634 \u06cc\u0639\u0646\u06cc \u062f\u0631 \u0627\u0648\u0646 \u06a9\u0627\u0646\u062a\u06a9\u0633\u062a\u06cc \u06a9\u0647 \u0627\u062c\u0631\u0627 \u0645\u06cc\u0634\u0647 \u063a\u06cc\u0631\u0642\u0627\u0628\u0644 \u062a\u0642\u0633\u06cc\u0645 \u0648 \u063a\u06cc\u0631\u0642\u0627\u0628\u0644 \u0648\u0642\u0641\u0647 \u0627\u0633\u062a. \u06cc\u0627 \u0647\u0645\u0647 \u0627\u0634 \u0631\u0648 \u0627\u0646\u062c\u0627\u0645 \u0628\u062f\u0647 \u06cc\u0627 \u0647\u06cc\u0686\u06cc. \u0686\u06cc\u0632\u06cc \u06a9\u0647 \u0627\u06cc\u0646\u062c\u0627 \u0645\u0647\u0645\u0647 \u06a9\u0627\u0646\u062a\u06a9\u0633\u062a \u0647\u0633\u062a\u0634\u060c \u06cc\u06a9 \u0686\u06cc\u0632\u06cc \u0645\u06cc\u062a\u0648\u0646\u0647 \u062f\u0631 \u06cc\u06a9 \u0644\u0627\u06cc\u0647 \u0627\u062a\u0645\u06cc\u06a9 \u0628\u0627\u0634\u0647 \u0648\u0644\u06cc \u062f\u0631 \u0644\u0627\u06cc\u0647 \u0647\u0627\u06cc \u062f\u06cc\u06af\u0631 \u0627\u062a\u0645\u06cc\u06a9 \u0646\u0628\u0627\u0634\u0647\n\u0645\u062b\u0644\u0627 \u0627\u06cc\u0646 \u062f\u0633\u062a\u0648\u0631 \u0633\u0627\u062f\u0647 ",(0,s.jsx)(e.code,{children:"++i"})," \u0645\u06cc\u062a\u0648\u0646\u0647 \u0627\u062a\u0645\u06cc\u06a9 \u0628\u0627\u0634\u0647 \u06cc\u0627 \u0646\u0647 \u0628\u0633\u062a\u06af\u06cc \u0628\u0647 \u06a9\u0627\u0646\u062a\u0633\u06a9 \u0645\u0627 \u062f\u0627\u0631\u0647"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u062f\u0631\u06cc\u0627\u0641\u062a \u0645\u0642\u062f\u0627\u0631 i"}),"\n",(0,s.jsx)(e.li,{children:"\u0627\u0641\u0632\u0627\u06cc\u0634 \u0645\u0642\u062f\u0627\u0631 i"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u062d\u0627\u0644\u0627 \u0645\u0645\u06a9\u0646\u0647 \u0647\u0631 \u06a9\u062f\u0648\u0645 \u0627\u0632 \u0627\u06cc\u0646 \u0645\u0631\u0627\u062d\u0644 ",(0,s.jsx)(e.strong,{children:"\u062f\u0631 \u0633\u0637\u062d CPU \u0628\u0647 \u062a\u0646\u0647\u0627\u06cc\u06cc \u0627\u062a\u0645\u06cc\u06a9 \u0628\u0627\u0634\u0646"}),"\u060c",(0,s.jsx)(e.br,{}),"\n","\u0648\u0644\u06cc ",(0,s.jsx)(e.strong,{children:"\u062a\u0631\u06a9\u06cc\u0628\u0634\u0648\u0646 \u0628\u0627 \u0647\u0645"})," \u0645\u0645\u06a9\u0646\u0647 \u0627\u062a\u0645\u06cc\u06a9 \u0646\u0628\u0627\u0634\u0647\u060c",(0,s.jsx)(e.br,{}),"\n","\u0645\u062e\u0635\u0648\u0635\u0627\u064b \u0627\u06af\u0647 ",(0,s.jsx)(e.strong,{children:"\u0686\u0646\u062f \u062a\u0627 Thread \u06cc\u0627 Process"})," \u0647\u0645\u0632\u0645\u0627\u0646 \u0628\u062e\u0648\u0627\u0646 \u0627\u06cc\u0646 \u062f\u0633\u062a\u0648\u0631 \u0631\u0648 \u0627\u062c\u0631\u0627 \u06a9\u0646\u0646."]}),"\n",(0,s.jsx)(e.p,{children:"\u06cc\u0627 \u0641\u0631\u0636 \u06a9\u0646 \u062f\u0627\u0631\u06cc\u0645 \u06cc\u0647 \u0631\u06a9\u0648\u0631\u062f \u062c\u062f\u06cc\u062f \u062a\u0648\u06cc \u06cc\u0647 \u062c\u062f\u0648\u0644 \u062f\u06cc\u062a\u0627\u0628\u06cc\u0633 \u0627\u0636\u0627\u0641\u0647 \u0645\u06cc\u200c\u06a9\u0646\u06cc\u0645:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"INSERT INTO users (id, name, balance) VALUES (1, 'Ali', 100);\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u062f\u0631 \u0633\u0637\u062d \u062f\u06cc\u062a\u0627\u0628\u06cc\u0633 \u0627\u06cc\u0646 \u062f\u0633\u062a\u0648\u0631 \u0627\u062a\u0645\u06cc\u06a9\u0647. \u06cc\u0639\u0646\u06cc \u06cc\u0627 \u06a9\u0644 \u0631\u06a9\u0648\u0631\u062f ",(0,s.jsx)(e.code,{children:"users"})," \u0628\u0627 \u0647\u0645\u0647 \u0633\u062a\u0648\u0646\u200c\u0647\u0627 \u0648\u0627\u0631\u062f \u0645\u06cc\u0634\u0647\u060c \u06cc\u0627 \u0627\u06af\u0647 \u062e\u0637\u0627\u06cc\u06cc \u067e\u06cc\u0634 \u0628\u06cc\u0627\u062f ",(0,s.jsx)(e.strong,{children:"\u0647\u06cc\u0686\u200c\u0686\u06cc\u0632\u06cc \u0648\u0627\u0631\u062f \u0646\u0645\u06cc\u200c\u0634\u0647"}),". \u067e\u0633 \u062a\u0648 \u0627\u06cc\u0646 \u0644\u0627\u06cc\u0647\u060c \u0627\u06cc\u0646 \u0639\u0645\u0644\u06cc\u0627\u062a ",(0,s.jsx)(e.strong,{children:"\u0627\u062a\u0645\u06cc\u06a9"})," \u0647\u0633\u062a."]}),"\n",(0,s.jsxs)(e.p,{children:["\u062d\u0627\u0644\u0627 \u0641\u0631\u0636 \u06a9\u0646 \u0645\u0627 \u0627\u0632 \u062f\u06cc\u062a\u0627\u0628\u06cc\u0633\u0645\u0648\u0646 \u0627\u0632 \u0637\u0631\u06cc\u0642 \u06cc\u0647 API \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u200c\u06a9\u0646\u06cc\u0645 \u0648 \u0686\u0646\u062f \u062a\u0627 \u0633\u0631\u0648\u0631 \u062f\u0627\u0631\u06cc\u0645. \u062d\u0627\u0644\u0627 \u062f\u0648 \u06a9\u0627\u0631\u0628\u0631 \u062a\u0642\u0631\u06cc\u0628\u0627\u064b \u0647\u0645\u200c\u0632\u0645\u0627\u0646 \u062f\u0631\u062e\u0648\u0627\u0633\u062a \u0645\u06cc\u200c\u0641\u0631\u0633\u062a\u0646 \u0628\u0631\u0627\u06cc \u0633\u0627\u062e\u062a \u06cc\u0648\u0632\u0631 \u0628\u0627 \u0647\u0645\u0648\u0646 ",(0,s.jsx)(e.code,{children:"id = 1"}),"."]}),"\n",(0,s.jsx)(e.p,{children:"\u0627\u06af\u0647 \u0645\u0627 \u062f\u0631 \u0633\u0637\u062d \u0627\u067e\u0644\u06cc\u06a9\u06cc\u0634\u0646 \u0642\u0628\u0644 \u0627\u0632 INSERT \u06cc\u0647 \u0686\u06a9 \u0628\u06a9\u0646\u06cc\u0645 \u06a9\u0647 \xab\u0622\u06cc\u0627 \u06a9\u0627\u0631\u0628\u0631\u06cc \u0628\u0627 \u0627\u06cc\u0646 id \u0648\u062c\u0648\u062f \u062f\u0627\u0631\u0647\u061f\xbb \u0648 \u0628\u0639\u062f \u062a\u0635\u0645\u06cc\u0645 \u0628\u06af\u06cc\u0631\u06cc\u0645 \u06a9\u0647 \u0631\u06a9\u0648\u0631\u062f \u0631\u0648 \u062f\u0631\u062c \u06a9\u0646\u06cc\u0645\u060c \u0645\u0645\u06a9\u0646\u0647 \u0627\u06cc\u0646 \u0633\u0646\u0627\u0631\u06cc\u0648 \u067e\u06cc\u0634 \u0628\u06cc\u0627\u062f:"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0627Thread A \u0628\u0631\u0631\u0633\u06cc \u0645\u06cc\u200c\u06a9\u0646\u0647 \u0648 \u0645\u06cc\u200c\u0628\u06cc\u0646\u0647 \u06a9\u0647 id = 1 \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u0647"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0647\u0645\u200c\u0632\u0645\u0627\u0646 Thread B \u0647\u0645 \u0647\u0645\u06cc\u0646 \u06a9\u0627\u0631 \u0631\u0648 \u0645\u06cc\u200c\u06a9\u0646\u0647"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0647\u0631 \u062f\u0648 \u0628\u0647 \u0627\u06cc\u0646 \u0646\u062a\u06cc\u062c\u0647 \u0645\u06cc\u200c\u0631\u0633\u0646 \u06a9\u0647 \u0628\u0627\u06cc\u062f \u0631\u06a9\u0648\u0631\u062f \u062f\u0631\u062c \u0628\u0634\u0647"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0647\u0631 \u062f\u0648 \u0647\u0645\u0632\u0645\u0627\u0646 \u0633\u0639\u06cc \u0645\u06cc\u200c\u06a9\u0646\u0646 INSERT \u0628\u0632\u0646\u0646"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u06cc\u06a9\u06cc \u0645\u0648\u0641\u0642 \u0645\u06cc\u0634\u0647\u060c \u06cc\u06a9\u06cc \u062e\u0637\u0627 \u0645\u06cc\u200c\u06af\u06cc\u0631\u0647"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"memory-access-synchronization",children:"Memory Access Synchronization"}),"\n",(0,s.jsxs)(e.p,{children:["\u0648\u0642\u062a\u06cc \u0686\u0646\u062f goroutine \u062f\u0627\u0631\u0646 \u0628\u0647 \u06cc\u0647 \u062a\u06a9\u0647 \u062d\u0627\u0641\u0638\u0647 (\u0645\u062b\u0644\u0627\u064b \u06cc\u0647 \u0645\u062a\u063a\u06cc\u0631 \u0645\u0634\u062a\u0631\u06a9) \u0647\u0645\u200c\u0632\u0645\u0627\u0646 \u062f\u0633\u062a\u0631\u0633\u06cc \u067e\u06cc\u062f\u0627 \u0645\u06cc\u200c\u06a9\u0646\u0646\u060c \u0628\u0627\u06cc\u062f \u06cc\u0647 \u062c\u0648\u0631\u06cc ",(0,s.jsx)(e.strong,{children:"\u0647\u0645\u0627\u0647\u0646\u06af\u0634\u0648\u0646 \u06a9\u0646\u06cc\u0645"})," \u06a9\u0647 \u062f\u0627\u062f\u0647 \u062e\u0631\u0627\u0628 \u0646\u0634\u0647.  \u0628\u0647 \u0627\u06cc\u0646 \u0647\u0645\u0627\u0647\u0646\u06af\u06cc \u0628\u0631\u0627\u06cc \u062f\u0633\u062a\u0631\u0633\u06cc \u0628\u0647 \u062d\u0627\u0641\u0638\u0647 \u0645\u06cc\u200c\u06af\u06cc\u0645 ",(0,s.jsx)(e.strong,{children:"Memory Access Synchronization"}),".\n\u062d\u0627\u0644\u0627 \u0627\u06af\u0647 \u0627\u06cc\u0646\u0627\u0631\u0648 \u0645\u062f\u06cc\u0631\u06cc\u062a \u0646\u06a9\u0646\u06cc\u0645 \u0645\u0645\u06a9\u0646\u0647 \u0686\u0646\u062f\u062a\u0627 \u062d\u0627\u0644\u062a \u067e\u06cc\u0634 \u0628\u06cc\u0627\u062f"]}),"\n",(0,s.jsx)(e.h3,{id:"deadlock",children:"DeadLock"}),"\n",(0,s.jsx)(e.p,{children:"\u062f\u062f\u0644\u0627\u06a9 \u0648\u0642\u062a\u06cc \u0627\u062a\u0641\u0627\u0642 \u0645\u06cc\u200c\u0627\u0641\u062a\u0647 \u06a9\u0647 \u0686\u0646\u062f \u062a\u0627 goroutine \u0645\u0646\u062a\u0638\u0631 \u0647\u0645\u062f\u06cc\u06af\u0647 \u0628\u0627\u0634\u0646 \u0648 \u0647\u06cc\u0686\u200c\u06a9\u062f\u0648\u0645 \u0646\u062a\u0648\u0646\u0647 \u06a9\u0627\u0631\u0634\u0648 \u0627\u062f\u0627\u0645\u0647 \u0628\u062f\u0647. \u0645\u062b\u0644\u0627 \u0641\u0631\u0636 \u06a9\u0646 \u062f\u0648 \u062a\u0627 \u0642\u0641\u0644 \u062f\u0627\u0631\u06cc\u0645. goroutine \u0627\u0648\u0644 \u0642\u0641\u0644 A \u0631\u0648 \u0645\u06cc\u200c\u06af\u06cc\u0631\u0647 \u0648 \u0645\u0646\u062a\u0638\u0631\u0647 \u0642\u0641\u0644 B \u0622\u0632\u0627\u062f \u0628\u0634\u0647\u060c \u0647\u0645\u200c\u0632\u0645\u0627\u0646 goroutine \u062f\u0648\u0645 \u0642\u0641\u0644 B \u0631\u0648 \u06af\u0631\u0641\u062a\u0647 \u0648 \u0627\u0648\u0646\u0645 \u0645\u0646\u062a\u0638\u0631\u0647 \u0642\u0641\u0644 A. \u0647\u06cc\u0686\u200c\u06a9\u062f\u0648\u0645 \u062d\u0627\u0636\u0631 \u0646\u06cc\u0633\u062a\u0646 \u0642\u0641\u0644 \u0631\u0648 \u0648\u0644 \u06a9\u0646\u0646\u060c \u067e\u0633 \u0628\u0631\u0646\u0627\u0645\u0647 \u0647\u0645\u06cc\u0646\u200c\u062c\u0648\u0631\u06cc \u06af\u06cc\u0631 \u0645\u06cc\u200c\u06a9\u0646\u0647 \u0648 \u0647\u06cc\u0686 \u0627\u062a\u0641\u0627\u0642\u06cc \u0646\u0645\u06cc\u200c\u0627\u0641\u062a\u0647."}),"\n",(0,s.jsx)(e.h3,{id:"livelock",children:"Livelock"}),"\n",(0,s.jsx)(e.p,{children:"\u0644\u0627\u06cc\u0648\u0644\u0627\u06a9 \u0634\u0628\u06cc\u0647 deadlock \u0647\u0633\u062a \u0648\u0644\u06cc \u06cc\u0647 \u062a\u0641\u0627\u0648\u062a \u062f\u0627\u0631\u0647. \u062a\u0648 deadlock \u0647\u0645\u0647 \u0645\u062a\u0648\u0642\u0641 \u0634\u062f\u0646\u060c \u0648\u0644\u06cc \u062a\u0648 livelock \u0647\u0645\u0647 \u062f\u0627\u0631\u0646 \u062d\u0631\u06a9\u062a \u0645\u06cc\u200c\u06a9\u0646\u0646\u060c \u0641\u0642\u0637 \u0647\u06cc\u0686\u200c\u06a9\u062f\u0648\u0645 \u0628\u0647 \u0646\u062a\u06cc\u062c\u0647 \u0646\u0645\u06cc\u200c\u0631\u0633\u0646. \u0627\u0646\u06af\u0627\u0631 \u062f\u0648 \u0646\u0641\u0631 \u0631\u0648\u0628\u0631\u0648\u06cc \u0647\u0645 \u0627\u06cc\u0633\u062a\u0627\u062f\u0646\u060c \u0647\u0631 \u062f\u0648 \u0645\u06cc\u200c\u062e\u0648\u0627\u0646 \u06a9\u0646\u0627\u0631 \u0628\u0631\u0646 \u062a\u0627 \u0631\u0627\u0647 \u0628\u062f\u0646\u060c \u0627\u0645\u0627 \u0647\u0631 \u0628\u0627\u0631 \u0647\u0645\u0632\u0645\u0627\u0646 \u062d\u0631\u06a9\u062a \u0645\u06cc\u200c\u06a9\u0646\u0646 \u0648 \u062f\u0648\u0628\u0627\u0631\u0647 \u062c\u0644\u0648\u06cc \u0647\u0645 \u0642\u0631\u0627\u0631 \u0645\u06cc\u200c\u06af\u06cc\u0631\u0646. \u0627\u06cc\u0646 \u0686\u0631\u062e\u0647 \u0647\u0645\u06cc\u0646\u200c\u062c\u0648\u0631\u06cc \u062a\u06a9\u0631\u0627\u0631 \u0645\u06cc\u200c\u0634\u0647 \u0648 \u062f\u0631 \u0646\u0647\u0627\u06cc\u062a \u0647\u06cc\u0686\u200c\u06a9\u0633 \u062c\u0644\u0648 \u0646\u0645\u06cc\u200c\u0631\u0647.\n\u0645\u062b\u0644\u0627\u064b \u0641\u0631\u0636 \u06a9\u0646 \u062f\u0648 goroutine \u062f\u0627\u0631\u06cc\u0645 \u06a9\u0647 \u0647\u0631 \u0648\u0642\u062a \u0645\u06cc\u200c\u0628\u06cc\u0646\u0646 \u0645\u0646\u0628\u0639\u06cc \u0627\u0634\u063a\u0627\u0644\u0647\u060c \u0633\u0631\u06cc\u0639 \u0639\u0642\u0628\u200c\u0646\u0634\u06cc\u0646\u06cc \u0645\u06cc\u200c\u06a9\u0646\u0646 \u0648 \u062f\u0648\u0628\u0627\u0631\u0647 \u0627\u0645\u062a\u062d\u0627\u0646 \u0645\u06cc\u200c\u06a9\u0646\u0646(\u0627\u0633\u062a\u06cc\u062a\u0634\u0648\u0646 \u0639\u0648\u0636 \u0645\u06cc\u0634\u0647). \u0627\u06af\u0631 \u0627\u06cc\u0646 \u0639\u0642\u0628\u200c\u0646\u0634\u06cc\u0646\u06cc\u200c\u0647\u0627 \u0648 \u062a\u0644\u0627\u0634\u200c\u0647\u0627 \u0628\u0647\u200c\u0634\u06a9\u0644\u06cc \u0628\u0627\u0634\u0647 \u06a9\u0647 \u0647\u0631 \u0628\u0627\u0631 \u062f\u0642\u06cc\u0642\u0627\u064b \u0628\u0627 \u0647\u0645 \u0627\u0646\u062c\u0627\u0645 \u0628\u0634\u0646\u060c \u0647\u06cc\u0686\u200c\u0648\u0642\u062a \u0628\u0647 \u0645\u0646\u0628\u0639 \u062f\u0633\u062a\u0631\u0633\u06cc \u067e\u06cc\u062f\u0627 \u0646\u0645\u06cc\u200c\u06a9\u0646\u0646. \u0628\u0631\u0646\u0627\u0645\u0647 \u06af\u06cc\u0631 \u0646\u0645\u06cc\u200c\u06a9\u0646\u0647 \u0645\u062b\u0644 deadlock\u060c \u0648\u0644\u06cc \u0647\u0645\u0686\u0646\u0627\u0646 \u0647\u06cc\u0686 \u067e\u06cc\u0634\u0631\u0641\u062a\u06cc \u0647\u0645 \u0627\u062a\u0641\u0627\u0642 \u0646\u0645\u06cc\u200c\u0627\u0641\u062a\u0647."}),"\n",(0,s.jsx)(e.h3,{id:"starvation",children:"Starvation"}),"\n",(0,s.jsx)(e.p,{children:"\u06af\u0631\u0633\u0646\u06af\u06cc \u0632\u0645\u0627\u0646\u06cc \u067e\u06cc\u0634 \u0645\u06cc\u0627\u062f \u06a9\u0647 \u06cc\u0647 goroutine \u0647\u06cc\u0686\u200c\u0648\u0642\u062a \u0628\u0647 \u0645\u0646\u0628\u0639\u06cc \u06a9\u0647 \u0644\u0627\u0632\u0645 \u062f\u0627\u0631\u0647 \u062f\u0633\u062a\u0631\u0633\u06cc \u067e\u06cc\u062f\u0627 \u0646\u0645\u06cc\u200c\u06a9\u0646\u0647. \u0645\u062b\u0644\u0627 \u0627\u06af\u0647 \u0645\u0646\u0627\u0628\u0639 \u0647\u0645\u06cc\u0634\u0647 \u062a\u0648\u0633\u0637 \u0628\u0642\u06cc\u0647 goroutine\u0647\u0627 \u0627\u0634\u063a\u0627\u0644 \u0628\u0627\u0634\u0646\u060c \u0627\u0648\u0646 \u06cc\u06a9\u06cc \u0628\u06cc\u200c\u0646\u0648\u0627 :) \u0647\u06cc\u0686\u200c\u0648\u0642\u062a \u0646\u0648\u0628\u062a\u0634 \u0646\u0645\u06cc\u200c\u0631\u0633\u0647. \u0646\u0647 \u0628\u0647 \u062e\u0627\u0637\u0631 \u0627\u06cc\u0646\u06a9\u0647 \u0642\u0641\u0644 \u0634\u062f\u0647 \u06cc\u0627 \u06af\u06cc\u0631 \u06a9\u0631\u062f\u0647\u060c \u0628\u0644\u06a9\u0647 \u0686\u0648\u0646 \u0627\u0648\u0644\u0648\u06cc\u062a \u06cc\u0627 \u0633\u06cc\u0627\u0633\u062a \u0627\u062c\u0631\u0627\u06cc \u0628\u0631\u0646\u0627\u0645\u0647 \u0627\u062c\u0627\u0632\u0647 \u0646\u0645\u06cc\u200c\u062f\u0647 \u0628\u0647\u0634 \u0628\u0631\u0633\u0647."}),"\n",(0,s.jsx)(e.h2,{id:"2-modeling-your-code-communicating-sequentional-process",children:"2. Modeling your Code: Communicating Sequentional Process"}),"\n",(0,s.jsx)(e.h2,{id:"3-gos-concurrency-building-blocks",children:"3. Go's Concurrency Building Blocks"}),"\n",(0,s.jsx)(e.h3,{id:"goroutine",children:"goroutine"}),"\n",(0,s.jsxs)(e.p,{children:["\u06af\u0648\u0631\u0648\u062a\u06cc\u0646 \u0647\u0627 \u067e\u0627\u06cc\u0647 \u0627\u06cc \u062a\u0631\u06cc\u0646 \u0648\u0627\u062d\u062f \u062f\u0631 \u0628\u0631\u0646\u0627\u0645\u0647 \u0647\u0627\u06cc go\u06cc \u0647\u0633\u062a\u0646. \u0647\u0631 \u0628\u0631\u0646\u0627\u0645\u0647 \u0627\u06cc \u06a9\u0647 \u0645\u0627 \u0627\u06cc\u062c\u0627\u062f \u0645\u06cc\u06a9\u0646\u06cc\u0645 \u062d\u062f\u0627\u0642\u0644 \u062f\u0627\u062e\u0644 \u06cc\u06a9 \u06af\u0648\u0631\u0648\u062a\u06cc\u0646 \u0627\u062c\u0631\u0627 \u0645\u06cc\u0634\u0647. \u06af\u0648\u0631\u062a\u06cc\u0646 \u0647\u0627 ",(0,s.jsx)(e.strong,{children:"green thread"})," \u0647\u0633\u062a\u0646 \u06a9\u0647 \u062a\u0648\u0633\u0637 runtime \u0645\u062f\u06cc\u0631\u06cc\u062a \u0645\u06cc\u0634\u0647. \u06af\u0648 \u0627\u0632 M/N model \u0628\u0631\u0627\u06cc \u0628\u0631\u0646\u0627\u0645\u0647 \u0631\u06cc\u0632\u06cc \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u06a9\u0646\u0647 \u0628\u0647 \u0627\u06cc\u0646 \u0645\u0639\u0646\u06cc \u06a9\u0647 \u06a9\u0647 n \u062a\u0627 green thread \u0628\u0647 m\u062a\u0627 thread \u0648\u0627\u0642\u0639\u06cc \u0645\u067e \u0645\u06cc\u0634\u0646 \u06cc\u0639\u0646\u06cc \u062f\u0631 \u062d\u06cc\u0646 \u0627\u06cc\u0646 \u0645\u067e\u067e\u06cc\u0646\u06af \u0645\u0645\u06a9\u0646\u0647 \u06a9\u062f \u0645\u0627 parallel \u06cc\u0627 concurrent \u0627\u062c\u0631\u0627 \u0634\u0647 \u06a9\u0647 \u062a\u0635\u0645\u06cc\u0645\u0634 \u062f\u0631 \u0627\u062e\u062a\u06cc\u0627\u0631 runtime \u06af\u0648 \u0647\u0633\u062a\u0634"]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"concurrency is a property of the code; parallelism is a property of the running program"})}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u0645\u0627 \u06a9\u062f\u0645\u0648\u0646 \u0631\u0648 \u0628\u0635\u0648\u0631\u062a \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u062a \u0645\u06cc\u0646\u0648\u06cc\u0633\u0645 \u0648 \u0627\u0645\u06cc\u062f\u0648\u0627\u0631\u06cc\u0645 \u06a9\u0647 \u0628\u0647 \u0635\u0648\u0631\u062a paralel \u0627\u062c\u0631\u0627 \u0634\u0647"}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0622\u06cc\u0627 \u0647\u0645\u06cc\u0634\u0647 paralelism \u0627\u0632 concurrency \u0628\u0647\u062a\u0631\u0647\u061f"})}),(0,s.jsx)(e.p,{children:"\u0642\u0637\u0639\u0627 \u062e\u06cc\u0631. parallelism \u0628\u0631\u0627\u06cc \u0645\u0633\u0627\u0626\u0644\u06cc \u0647\u0633\u062a\u0634 \u06a9\u0647 CPU-bound \u0647\u0633\u062a\u0646 \u06cc\u0639\u0646\u06cc \u067e\u0631\u062f\u0627\u0632\u0634 \u0645\u0648\u0627\u0632\u06cc \u0628\u0627\u0639\u062b \u0627\u0641\u0632\u0627\u06cc\u0634 \u0633\u0631\u0639\u062a \u067e\u0631\u0627\u0633\u0633 \u0645\u06cc\u0634\u0646 \u0648\u0644\u06cc \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u0628\u0631\u0627\u06cc \u0645\u0633\u0627\u0626\u0644 IO-Bound \u0647\u0633\u062a\u0646 \u0645\u062b\u0644\u0627 \u062a\u0627 \u0632\u0645\u0627\u0646\u06cc \u06a9\u0647 \u06a9\u0627\u0646\u06a9\u0634\u0646 \u062f\u06cc\u062a\u0627\u0628\u06cc\u0633 \u0622\u0645\u0627\u062f\u0647 \u0646\u0634\u062f\u0647 \u06cc\u0647 \u06a9\u0627\u0631 \u062f\u06cc\u06af\u0647 \u0628\u06a9\u0646\u06cc\u0645"})]}),"\n",(0,s.jsx)(e.h4,{id:"fork-join-model",children:"Fork-join Model"}),"\n",(0,s.jsxs)(e.p,{children:["\u062a\u0648 Go\u060c \u0645\u062f\u0644 fork-join \u06cc\u0639\u0646\u06cc \u06a9\u0627\u0631 \u0627\u0635\u0644\u06cc \u0631\u0648 \u0628\u0647 \u0686\u0646\u062f goroutine \u062a\u0642\u0633\u06cc\u0645 \u0645\u06cc\u200c\u06a9\u0646\u06cc (fork) \u0648 \u0628\u0639\u062f \u0635\u0628\u0631 \u0645\u06cc\u200c\u06a9\u0646\u06cc \u0647\u0645\u0647 \u062a\u0645\u0648\u0645 \u0634\u0646 \u062a\u0627 \u0627\u062f\u0627\u0645\u0647 \u0628\u062f\u06cc (join). join \u0645\u06cc\u200c\u062a\u0648\u0646\u0647 \u0628\u0627 ",(0,s.jsx)(e.code,{children:"WaitGroup"})," \u06cc\u0627 channel \u0627\u0646\u062c\u0627\u0645 \u0628\u0634\u0647\u060c \u0648 \u0628\u062f\u0648\u0646 \u0647\u06cc\u0686 sync\u060c \u0645\u0645\u06a9\u0646\u0647 go-routine \u0647\u0627 \u0627\u062c\u0631\u0627 \u0646\u0634\u0646 \u0686\u0648\u0646 main \u0632\u0648\u062f \u062a\u0645\u0648\u0645 \u0645\u06cc\u0634\u0647."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"sync"\n)\n\n// worker simulates some work for a given ID\nfunc worker(id int, wg *sync.WaitGroup) {\n\tdefer wg.Done() // signal that this goroutine is done\n\tfmt.Printf("Worker %d started\\n", id)\n\t// simulate some work\n\t// time.Sleep(time.Second) // optional\n\tfmt.Printf("Worker %d finished\\n", id)\n}\n\nfunc main() {\n\tvar wg sync.WaitGroup\n\n\t// Fork: start multiple goroutines\n\tfor i := 1; i <= 5; i++ {\n\t\twg.Add(1)        // increment WaitGroup counter\n\t\tgo worker(i, &wg) // start goroutine\n\t}\n\n\t// Join: wait for all goroutines to finish\n\twg.Wait()\n\n\tfmt.Println("All workers finished, continue main flow...")\n}\n\n'})}),"\n",(0,s.jsx)(e.h4,{id:"mutex-and-rwmutex",children:"Mutex and RWMutex"}),"\n",(0,s.jsxs)(e.p,{children:["\u062a\u0648 Go\u060c ",(0,s.jsx)(e.code,{children:"Mutex"})," \u0648 ",(0,s.jsx)(e.code,{children:"RWMutex"})," \u0627\u0628\u0632\u0627\u0631\u0647\u0627\u06cc\u06cc \u0628\u0631\u0627\u06cc \u0647\u0645\u0632\u0645\u0627\u0646\u06cc \u0647\u0633\u062a\u0646 \u06a9\u0647 \u062f\u0633\u062a\u0631\u0633\u06cc \u0633\u06cc\u0641 \u0628\u0647 \u062f\u0627\u062f\u0647\u200c\u0647\u0627\u06cc \u0645\u0634\u062a\u0631\u06a9 \u0631\u0648 \u0641\u0631\u0627\u0647\u0645 \u0645\u06cc\u200c\u06a9\u0646\u0646. ",(0,s.jsx)(e.code,{children:"Mutex"}),' \u06cc\u0627 \u0647\u0645\u0648\u0646 "mutual exclusion" \u0648\u0642\u062a\u06cc \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u200c\u0634\u0647 \u06a9\u0647 \u0645\u06cc\u200c\u062e\u0648\u0627\u06cc \u06cc\u0647 \u0628\u062e\u0634 \u06a9\u062f \u0631\u0648 \u0628\u0647 \u0635\u0648\u0631\u062a ',(0,s.jsx)(e.strong,{children:"\u0627\u0646\u062d\u0635\u0627\u0631\u06cc"})," \u0645\u062d\u0627\u0641\u0638\u062a \u06a9\u0646\u06cc\u061b \u06cc\u0639\u0646\u06cc \u0648\u0642\u062a\u06cc \u06cc\u0647 goroutine ",(0,s.jsx)(e.code,{children:"Lock()"})," \u0645\u06cc\u200c\u06a9\u0646\u0647\u060c \u0628\u0642\u06cc\u0647 \u0628\u0627\u06cc\u062f \u0635\u0628\u0631 \u06a9\u0646\u0646 \u062a\u0627 ",(0,s.jsx)(e.code,{children:"Unlock()"})," \u0628\u0634\u0647. \u0645\u0639\u0645\u0648\u0644\u0627\u064b \u0627\u0632 ",(0,s.jsx)(e.code,{children:"defer lock.Unlock()"})," \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u200c\u06a9\u0646\u0646 \u062a\u0627 \u062d\u062a\u06cc \u0627\u06af\u0647 \u0641\u0627\u0646\u06a9\u0634\u0646 panic \u06a9\u0646\u0647\u060c \u0642\u0641\u0644 \u0622\u0632\u0627\u062f \u0628\u0634\u0647."]}),"\n",(0,s.jsxs)(e.p,{children:["\u0627",(0,s.jsx)(e.code,{children:"RWMutex"}),' \u06cc\u0627 "Read/Write Mutex" \u0645\u0634\u0627\u0628\u0647 ',(0,s.jsx)(e.code,{children:"Mutex"})," \u0639\u0645\u0644 \u0645\u06cc\u200c\u06a9\u0646\u0647 \u0648\u0644\u06cc \u0628\u0627 \u06a9\u0646\u062a\u0631\u0644 \u062f\u0642\u06cc\u0642\u200c\u062a\u0631: \u0686\u0646\u062f goroutine \u0645\u06cc\u200c\u062a\u0648\u0646\u0646 \u0647\u0645\u0632\u0645\u0627\u0646 \u062f\u0627\u062f\u0647\u200c\u0647\u0627 \u0631\u0648 \u0628\u062e\u0648\u0646\u0646 (",(0,s.jsx)(e.code,{children:"RLock()"}),")\u060c \u0648\u0644\u06cc \u0648\u0642\u062a\u06cc \u06cc\u0647 goroutine \u0628\u062e\u0648\u0627\u062f \u0628\u0646\u0648\u06cc\u0633\u0647 (",(0,s.jsx)(e.code,{children:"Lock()"}),")\u060c \u062f\u0633\u062a\u0631\u0633\u06cc \u0647\u0645\u0647 \u062e\u0648\u0627\u0646\u0646\u062f\u0647\u200c\u0647\u0627 \u0648 \u0646\u0648\u06cc\u0633\u0646\u062f\u0647\u200c\u0647\u0627\u06cc \u062f\u06cc\u06af\u0647 \u0645\u0633\u062f\u0648\u062f \u0645\u06cc\u200c\u0634\u0647. \u0627\u06cc\u0646 \u0628\u0627\u0639\u062b \u0645\u06cc\u200c\u0634\u0647 \u062a\u0648 \u0633\u0646\u0627\u0631\u06cc\u0648\u0647\u0627\u06cc\u06cc \u06a9\u0647 \u062a\u0639\u062f\u0627\u062f \u062e\u0648\u0627\u0646\u0646\u062f\u0647\u200c\u0647\u0627 \u0632\u06cc\u0627\u062f\u0647 \u0648 \u0646\u0648\u06cc\u0633\u0646\u062f\u0647\u200c\u0647\u0627 \u06a9\u0645\u060c \u0639\u0645\u0644\u06a9\u0631\u062f \u0628\u0647\u062a\u0631 \u0628\u0627\u0634\u0647."]}),"\n",(0,s.jsx)(e.p,{children:'\u0647\u0631 \u062f\u0648 \u0628\u0631\u0627\u06cc \u0647\u0645\u06af\u0627\u0645\u200c\u0633\u0627\u0632\u06cc \u062d\u0627\u0641\u0638\u0647 \u062f\u0631 \u0645\u0642\u06cc\u0627\u0633 \u06a9\u0648\u0686\u06a9 \u0648 \u0645\u062d\u0644\u06cc \u0645\u0641\u06cc\u062f \u0647\u0633\u062a\u0646 \u0648 \u0645\u06a9\u0645\u0644 \u0627\u0628\u0632\u0627\u0631\u0647\u0627\u06cc \u0647\u0645\u0632\u0645\u0627\u0646\u06cc \u062f\u06cc\u06af\u0647 \u0645\u062b\u0644 channel\u0647\u0627 \u0647\u0633\u062a\u0646. Go \u0627\u0635\u0648\u0644\u0627\u064b \u062a\u0648\u0635\u06cc\u0647 \u0645\u06cc\u200c\u06a9\u0646\u0647 "share memory by communicating" \u0648\u0644\u06cc \u0648\u0642\u062a\u06cc \u0644\u0627\u0632\u0645 \u0628\u0627\u0634\u0647\u060c \u0627\u06cc\u0646 \u0642\u0641\u0644\u200c\u0647\u0627 \u0627\u0628\u0632\u0627\u0631 \u0645\u0646\u0627\u0633\u0628\u06cc \u0647\u0633\u062a\u0646.'}),"\n",(0,s.jsxs)(e.admonition,{type:"note",children:[(0,s.jsxs)(e.p,{children:["\u0628\u0631\u0627\u06cc \u0633\u06cc\u06af\u0646\u0627\u0644 \u062f\u0627\u062f\u0646 \u062a\u0648 Go \u0627\u0632 struct"," \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u200c\u06a9\u0646\u0646 \u0686\u0648\u0646 \u062d\u062c\u0645\u0634 \u0635\u0641\u0631\u0647 \u0648 \u062d\u0627\u0641\u0638\u0647 \u0627\u0636\u0627\u0641\u0647 \u0645\u0635\u0631\u0641 \u0646\u0645\u06cc\u200c\u06a9\u0646\u0647\u060c \u0639\u0644\u0627\u0648\u0647 \u0628\u0631 \u0627\u06cc\u0646\u06a9\u0647 \u0645\u0634\u062e\u0635 \u0645\u06cc\u200c\u06a9\u0646\u0647 \u0641\u0642\u0637 \u0648\u062c\u0648\u062f \u0633\u06cc\u06af\u0646\u0627\u0644 \u0645\u0647\u0645\u0647 \u0648 \u0645\u0642\u062f\u0627\u0631\u0634 \u0627\u0647\u0645\u06cc\u062a\u06cc \u0646\u062f\u0627\u0631\u0647\u060c \u0628\u0631 \u062e\u0644\u0627\u0641 bool \u06a9\u0647 \u0645\u0645\u06a9\u0646\u0647 \u0628\u0627\u0639\u062b \u0633\u0631\u062f\u0631\u06af\u0645\u06cc \u06cc\u0627 \u0645\u0635\u0631\u0641 \u062d\u0627\u0641\u0638\u0647 \u0627\u0636\u0627\u0641\u06cc \u0628\u0634\u0647."]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"done := make(chan struct{})\ndone <- struct{}{} // send signal\n<-done             // receive signal\n"})})]}),"\n",(0,s.jsx)(e.h4,{id:"cond",children:"Cond"}),"\n",(0,s.jsx)(e.h4,{id:"once",children:"Once"}),"\n",(0,s.jsx)(e.h4,{id:"pool",children:"Pool"}),"\n",(0,s.jsx)(e.h2,{id:"4-concurrency-patterns-in-go",children:"4. Concurrency patterns in Go"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627\u06cc\u0646 \u0631\u0627\u0647\u0646\u0645\u0627 \u0647\u0631 \u06a9\u062f\u0648\u0645 \u0627\u0632 \u0627\u0644\u06af\u0648\u0647\u0627\u06cc \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u062f\u0631 Go \u06a9\u0647 \u06af\u0641\u062a\u06cc \u0631\u0648 ",(0,s.jsx)(e.strong,{children:"\u062e\u06cc\u0644\u06cc \u0645\u0641\u0635\u0644"})," \u062a\u0648\u0636\u06cc\u062d \u0645\u06cc\u200c\u062f\u0647: \u062a\u0639\u0631\u06cc\u0641\u060c \u0645\u0648\u0627\u0631\u062f \u0627\u0633\u062a\u0641\u0627\u062f\u0647\u060c \u0646\u06a9\u0627\u062a \u067e\u0631\u0648\u0688\u0627\u06a9\u0634\u0646\u060c \u062a\u0644\u0647\u200c\u0647\u0627\u06cc \u0631\u0627\u06cc\u062c\u060c \u0648 \u0645\u062b\u0627\u0644 \u06a9\u062f \u062a\u0645\u06cc\u0632. \u06a9\u062f\u0647\u0627 \u0647\u0645\u0647 \u0628\u0627 ",(0,s.jsx)(e.code,{children:"context"})," \u0648 \u062a\u0645\u0647\u06cc\u062f\u0627\u062a \u0636\u062f-leak \u0646\u0648\u0634\u062a\u0647 \u0634\u062f\u0646."]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-1-confinement-actor-style-ownership",children:"\ud83d\udd12 1) Confinement (Actor-style Ownership)"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0627\u06cc\u062f\u0647:"})," \u06cc\u06a9 goroutine \xab\u0645\u0627\u0644\u06a9\xbb \u062f\u0627\u062f\u0647 \u0627\u0633\u062a\u061b \u0628\u0642\u06cc\u0647 \u0641\u0642\u0637 \u0627\u0632 \u0637\u0631\u06cc\u0642 \u067e\u06cc\u0627\u0645 (channel) \u0628\u0627 \u0627\u06cc\u0646 \u0645\u0627\u0644\u06a9 \u062d\u0631\u0641 \u0645\u06cc\u200c\u0632\u0646\u0646\u062f. \u0642\u0641\u0644\u200c\u0647\u0627 (mutex) \u0628\u0647 \u062d\u062f\u0627\u0642\u0644 \u0645\u06cc\u200c\u0631\u0633\u0646\u062f \u0648 invariants \u0645\u0631\u06a9\u0632\u06cc \u0633\u0627\u062f\u0647\u200c\u062a\u0631 \u0645\u06cc\u200c\u0634\u0648\u062f."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u06a9\u0650\u06cc \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646\u06cc\u0645\u061f"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0648\u0642\u062a\u06cc state \u0627\u0634\u062a\u0631\u0627\u06a9\u06cc \u062d\u0633\u0627\u0633 \u062f\u0627\u0631\u06cc\u0645 (\u0645\u062b\u0644\u0627\u064b ",(0,s.jsx)(e.code,{children:"map"}),", LRU cache, \u062d\u0633\u0627\u0628 \u0628\u0627\u0646\u06a9\u06cc) \u0648 \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc\u0645 race \u0646\u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u06cc\u0645."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0632\u0645\u0627\u0646\u06cc \u06a9\u0647 throughput \u0628\u0627\u0644\u0627 \u0648\u0644\u06cc \u0627\u0644\u06af\u0648\u06cc \u062f\u0633\u062a\u0631\u0633\u06cc \u0633\u0627\u062f\u0647/\u0633\u0631\u06cc\u0627\u0644\u06cc \u0627\u0633\u062a."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0645\u0632\u0627\u06cc\u0627:"})," \u0633\u0627\u062f\u0647\u200c\u0633\u0627\u0632\u06cc reasoning\u060c \u062d\u0630\u0641 deadlock \u06a9\u0644\u0627\u0633\u06cc\u06a9\u060c encapsulation.",(0,s.jsx)(e.br,{}),"\n",(0,s.jsx)(e.strong,{children:"\u0645\u0639\u0627\u06cc\u0628:"})," \u0645\u0645\u06a9\u0646 \u0627\u0633\u062a \u06cc\u06a9 bottleneck \u0633\u0631\u06cc\u0627\u0644\u06cc \u0628\u0633\u0627\u0632\u062f\u061b \u0627\u06af\u0631 latency \u06cc\u06a9 \u067e\u06cc\u0627\u0645 \u0632\u06cc\u0627\u062f \u0634\u0648\u062f\u060c \u0647\u0645\u0647 \u0635\u0628\u0631 \u0645\u06cc\u200c\u06a9\u0646\u0646\u062f."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0627\u0644\u06af\u0648\u06cc \u06a9\u0644\u06cc (mini-actor):"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:'package actor\n\nimport (\n    "context"\n)\n\ntype Command interface{}\n\ntype Get struct{ Reply chan<- int }\ntype Add struct{ N int }\n\ntype Counter struct {\n    cmds chan Command\n}\n\nfunc NewCounter(buffer int) *Counter {\n    return &Counter{cmds: make(chan Command, buffer)}\n}\n\nfunc (c *Counter) Run(ctx context.Context) {\n    var val int\n    for {\n        select {\n        case <-ctx.Done():\n            return\n        case cmd := <-c.cmds:\n            switch m := cmd.(type) {\n            case Add:\n                val += m.N\n            case Get:\n                // non-blocking safety: \u0627\u06af\u0631 \u0645\u0635\u0631\u0641\u200c\u06a9\u0646\u0646\u062f\u0647 crash \u06a9\u0631\u062f \u0628\u0627\u0639\u062b deadlock \u0646\u0634\u0648\u06cc\u0645\n                select {\n                case m.Reply <- val:\n                case <-ctx.Done():\n                    return\n                }\n            }\n        }\n    }\n}\n\nfunc (c *Counter) Add(n int) { c.cmds <- Add{N: n} }\n\nfunc (c *Counter) Get(ctx context.Context) (int, bool) {\n    reply := make(chan int, 1)\n    select {\n    case c.cmds <- Get{Reply: reply}:\n    case <-ctx.Done():\n        return 0, false\n    }\n    select {\n    case v := <-reply:\n        return v, true\n    case <-ctx.Done():\n        return 0, false\n    }\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a \u067e\u0631\u0648\u0688\u0627\u06a9\u0634\u0646:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0647\u0645\u06cc\u0634\u0647 ",(0,s.jsx)(e.code,{children:"ctx.Done()"})," \u0631\u0627 \u062f\u0631 loop \u0686\u06a9 \u06a9\u0646\u06cc\u062f."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u06a9\u0627\u0646\u0627\u0644\u200c\u0647\u0627 \u0631\u0627 buffer\u062f\u0627\u0631 \u0628\u06af\u06cc\u0631\u06cc\u062f \u062a\u0627 backpressure \u0645\u062f\u06cc\u0631\u06cc\u062a \u0634\u0648\u062f (\u0628\u0633\u062a\u0647 \u0628\u0647 SLA)."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0627\u0632 counters/metrics (\u0645\u0627\u0646\u0646\u062f \u0637\u0648\u0644 \u0635\u0641) \u0628\u0631\u0627\u06cc capacity planning \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646\u06cc\u062f."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-2-for-select-loop",children:"\ud83d\udd04 2) for-select Loop"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0627\u0644\u06af\u0648:"})," \u062d\u0644\u0642\u0647\u200c\u06cc \u0628\u06cc\u200c\u0646\u0647\u0627\u06cc\u062a \u0628\u0627 ",(0,s.jsx)(e.code,{children:"select"})," \u0628\u0631\u0627\u06cc multiplex \u0631\u0648\u06cc \u0686\u0646\u062f \u06a9\u0627\u0646\u0627\u0644 + cancel."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a \u0645\u0647\u0645:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0628\u0631\u0627\u06cc timeouts \u0627\u0632 ",(0,s.jsx)(e.code,{children:"time.NewTimer"}),"/",(0,s.jsx)(e.code,{children:"time.Ticker"})," \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646\u06cc\u062f (\u0646\u0647 ",(0,s.jsx)(e.code,{children:"time.After"})," \u062f\u0631 \u062d\u0644\u0642\u0647\u0654 \u062a\u0646\u06af) \u062a\u0627 leak \u062a\u0627\u06cc\u0645\u0631 \u0646\u062f\u0647\u06cc\u062f."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"default"})," \u062f\u0631 ",(0,s.jsx)(e.code,{children:"select"})," \u06cc\u0639\u0646\u06cc non-blocking\u061b \u0628\u0627 \u0627\u062d\u062a\u06cc\u0627\u0637 \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646\u06cc\u062f \u06a9\u0647 busy-loop \u0646\u0633\u0627\u0632\u06cc\u062f."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0645\u062b\u0627\u0644 \u0628\u0627 heartbeat \u0648 idle-timeout \u062f\u0631\u0633\u062a:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:'func serve(ctx context.Context, in <-chan string, out chan<- string) error {\n    defer close(out)\n\n    heartbeat := time.NewTicker(5 * time.Second)\n    defer heartbeat.Stop()\n\n    idle := time.NewTimer(30 * time.Second)\n    defer idle.Stop()\n\n    resetIdle := func() {\n        if !idle.Stop() {\n            select { case <-idle.C: default: }\n        }\n        idle.Reset(30 * time.Second)\n    }\n\n    for {\n        select {\n        case <-ctx.Done():\n            return ctx.Err()\n        case <-heartbeat.C:\n            select { case out <- "ping": case <-ctx.Done(): return ctx.Err() }\n        case <-idle.C:\n            return errors.New("idle timeout")\n        case msg, ok := <-in:\n            if !ok { return nil }\n            resetIdle()\n            // \u067e\u0631\u062f\u0627\u0632\u0634 msg\n            select { case out <- strings.ToUpper(msg): case <-ctx.Done(): return ctx.Err() }\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-3-preventing-goroutine-leaks",children:"\ud83d\uded1 3) Preventing Goroutine Leaks"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0645\u0634\u06a9\u0644\u0627\u062a \u0631\u0627\u06cc\u062c:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627",(0,s.jsx)(e.code,{children:"range"})," \u0631\u0648\u06cc \u06a9\u0627\u0646\u0627\u0644\u06cc \u06a9\u0647 \u0647\u0631\u06af\u0632 \u0628\u0633\u062a\u0647 \u0646\u0645\u06cc\u200c\u0634\u0648\u062f."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0627goroutine \u0645\u0646\u062a\u0638\u0631 \u0631\u0648\u06cc send \u0628\u0647 \u06a9\u0627\u0646\u0627\u0644 \u0628\u062f\u0648\u0646 \u0645\u0635\u0631\u0641\u200c\u06a9\u0646\u0646\u062f\u0647."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0627\u0632 ",(0,s.jsx)(e.code,{children:"time.After"})," \u062f\u0631 loop \u2192 \u0633\u0627\u062e\u062a\u0646 \u062a\u0627\u06cc\u0645\u0631\u0647\u0627\u06cc \u0631\u0647\u0627\u0634\u062f\u0647."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0631\u0627\u0647\u06a9\u0627\u0631\u0647\u0627:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0647\u0645\u06cc\u0634\u0647 ",(0,s.jsx)(e.code,{children:"ctx.Done()"})," \u0631\u0627 \u062f\u0631 ",(0,s.jsx)(e.code,{children:"select"})," \u0628\u06af\u0630\u0627\u0631."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"close \u0645\u0633\u06cc\u0631\u0647\u0627\u06cc \u062e\u0631\u0648\u062c\u06cc \u0631\u0627 \u0645\u062f\u06cc\u0631\u06cc\u062a \u06a9\u0646."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u062f\u0631 \u062a\u0633\u062a\u200c\u0647\u0627 \u0627\u0632 ",(0,s.jsx)(e.code,{children:"go.uber.org/goleak"})," \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0628\u0631\u0627\u06cc fan-out/fan-in \u062d\u062a\u0645\u0627\u064b done/cancel \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0627\u0644\u06af\u0648\u06cc \u067e\u0627\u06cc\u0647\u0654 anti-leak \u0628\u0631\u0627\u06cc \u0645\u0635\u0631\u0641\u200c\u06a9\u0646\u0646\u062f\u0647:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func consume(ctx context.Context, in <-chan Item) {\n    for {\n        select {\n        case <-ctx.Done():\n            return\n        case it, ok := <-in:\n            if !ok { return }\n            _ = process(it)\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-4-or-channel",children:"\u26a1 4) or-channel"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0645\u0633\u0626\u0644\u0647:"})," \u0686\u0646\u062f \u0633\u06cc\u06af\u0646\u0627\u0644 cancel/done \u062f\u0627\u0631\u06cc\u0645\u061b \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc\u0645 \u0627\u0648\u0644\u06cc\u0646\u200c\u0634\u0627\u0646 \u0647\u0645\u0647\u200c\u0686\u06cc\u0632 \u0631\u0627 \u0645\u062a\u0648\u0642\u0641 \u06a9\u0646\u062f."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u067e\u06cc\u0627\u062f\u0647\u200c\u0633\u0627\u0632\u06cc \u0633\u0627\u062f\u0647 \u0648 \u0627\u0645\u0646 (N goroutine + sync.Once):"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func Or(chs ...<-chan struct{}) <-chan struct{} {\n    switch len(chs) {\n    case 0:\n        c := make(chan struct{})\n        close(c)\n        return c\n    case 1:\n        return chs[0]\n    }\n    out := make(chan struct{})\n    var once sync.Once\n\n    signal := func(ch <-chan struct{}) {\n        select {\n        case <-ch:\n            once.Do(func() { close(out) })\n        case <-out:\n        }\n    }\n\n    for _, ch := range chs {\n        go signal(ch)\n    }\n    return out\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u062a\u0647:"})," \u0628\u0631\u0627\u06cc request-scoped \u06a9\u0627\u0631\u0647\u0627\u060c \u0645\u0639\u0645\u0648\u0644\u0627\u064b \u0628\u0647 \u062c\u0627\u06cc or-channel \u0627\u0632 \u06cc\u06a9 ",(0,s.jsx)(e.code,{children:"context"})," \u0645\u0634\u062a\u0631\u06a9 \u0628\u0627 ",(0,s.jsx)(e.code,{children:"errgroup"})," \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u200c\u06a9\u0646\u06cc\u0645 \u062a\u0627 cancel \u0622\u0628\u0634\u0627\u0631\u06cc \u0634\u0648\u062f (\u062a\u0645\u06cc\u0632\u062a\u0631)."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-5-\u0627error-handling-\u062f\u0631-\u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc",children:"\ud83d\udea8 5) \u0627Error Handling \u062f\u0631 \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0627\u0644\u06af\u0648\u0647\u0627\u06cc \u0631\u0627\u06cc\u062c:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627",(0,s.jsx)(e.code,{children:"errgroup.Group"})," \u0627\u0632 ",(0,s.jsx)(e.code,{children:"golang.org/x/sync/errgroup"})," \u2192 cancel \u0627\u062a\u0648\u0645\u0627\u062a\u06cc\u06a9 \u0628\u0627 \u0627\u0648\u0644\u06cc\u0646 \u062e\u0637\u0627."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u06a9\u0627\u0646\u0627\u0644 error \u0628\u0627 \u0628\u0627\u0641\u0631 1 \u062a\u0627 block \u0646\u0634\u0648\u062f."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u062c\u0645\u0639\u200c\u06a9\u0631\u062f\u0646 \u0686\u0646\u062f \u062e\u0637\u0627 \u0628\u0627 ",(0,s.jsx)(e.code,{children:"go.uber.org/multierr"})," (\u0648\u0642\u062a\u06cc \u0647\u0645\u0647\u0654 \u06a9\u0627\u0631\u0647\u0627 \u0631\u0627 \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc \u062a\u0645\u0627\u0645 \u06a9\u0646\u06cc \u0648 \u0628\u0639\u062f \u06af\u0632\u0627\u0631\u0634 \u0628\u062f\u0647\u06cc)."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0645\u062b\u0627\u0644 \u0628\u0627 errgroup + context:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:'import (\n    "golang.org/x/sync/errgroup"\n)\n\nfunc crawlAll(ctx context.Context, urls []string) error {\n    g, ctx := errgroup.WithContext(ctx)\n    sem := make(chan struct{}, 8) // \u0645\u062d\u062f\u0648\u062f\u06cc\u062a \u0647\u0645\u0632\u0645\u0627\u0646\u06cc\n\n    for _, u := range urls {\n        u := u\n        g.Go(func() error {\n            select { case sem <- struct{}{}: case <-ctx.Done(): return ctx.Err() }\n            defer func() { <-sem }()\n            body, err := fetch(ctx, u)\n            if err != nil { return err }\n            return store(ctx, u, body)\n        })\n    }\n    return g.Wait()\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-6-pipelines",children:"\ud83d\udce6 6) Pipelines"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0627\u06cc\u062f\u0647:"})," \u062f\u0627\u062f\u0647 \u0627\u0632 \u0686\u0646\u062f \u0645\u0631\u062d\u0644\u0647 \u0645\u06cc\u200c\u06af\u0630\u0631\u062f\u061b \u0647\u0631 \u0645\u0631\u062d\u0644\u0647 goroutine \u062e\u0648\u062f\u0634 \u0631\u0627 \u062f\u0627\u0631\u062f \u0648 \u0627\u0632 channel \u0628\u0631\u0627\u06cc \u0627\u0646\u062a\u0642\u0627\u0644 \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u0645\u06cc\u200c\u06a9\u0646\u062f."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a \u06a9\u0644\u06cc\u062f\u06cc:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0647\u0631 stage \u0628\u0627\u06cc\u062f \u062e\u0631\u0648\u062c\u06cc\u200c\u0627\u0634 \u0631\u0627 \u0628\u0628\u0646\u062f\u062f \u0648\u0642\u062a\u06cc input \u062a\u0645\u0627\u0645 \u0634\u062f."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0628\u0627\u06cc\u062f cancel \u0631\u0627 propagate \u06a9\u0646\u06cc (\u0628\u0627 ",(0,s.jsx)(e.code,{children:"ctx"})," \u06cc\u0627 ",(0,s.jsx)(e.code,{children:"done"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"backpressure \u062e\u0648\u062f\u0628\u0647\u200c\u062e\u0648\u062f \u0628\u0627 channel \u06a9\u0646\u062a\u0631\u0644 \u0645\u06cc\u200c\u0634\u0648\u062f."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0645\u062b\u0627\u0644:"})," read \u2192 parse \u2192 validate \u2192 write"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func gen(ctx context.Context, ns ...int) <-chan int {\n    out := make(chan int)\n    go func() {\n        defer close(out)\n        for _, n := range ns {\n            select { case out <- n: case <-ctx.Done(): return }\n        }\n    }()\n    return out\n}\n\nfunc sq(ctx context.Context, in <-chan int) <-chan int {\n    out := make(chan int)\n    go func() {\n        defer close(out)\n        for n := range in {\n            n := n\n            select { case out <- n * n: case <-ctx.Done(): return }\n        }\n    }()\n    return out\n}\n\nfunc pipeline(ctx context.Context) []int {\n    var res []int\n    for v := range sq(ctx, sq(ctx, gen(ctx, 1,2,3,4))) {\n        res = append(res, v)\n    }\n    return res\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Production tips:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0628\u0631\u0627\u06cc stages \u0633\u0646\u06af\u06cc\u0646\u060c fan-out \u06a9\u0646 (\u0686\u0646\u062f \u0646\u0633\u062e\u0647\u0654 \u0645\u0648\u0627\u0632\u06cc \u0647\u0645\u0627\u0646 stage)."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0627\u0632 metrics \u0628\u0631\u0627\u06cc \u0647\u0631 stage (QPS\u060c latency\u060c \u0639\u0645\u0642 \u0635\u0641) \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-7-fan-out-fan-in-worker-pool",children:"\ud83c\udf2a 7) Fan-Out, Fan-In (Worker Pool)"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Fan-Out:"})," \u062a\u0642\u0633\u06cc\u0645 \u06a9\u0627\u0631 \u0628\u06cc\u0646 \u0686\u0646\u062f worker.",(0,s.jsx)(e.br,{}),"\n",(0,s.jsx)(e.strong,{children:"Fan-In:"})," \u0627\u062f\u063a\u0627\u0645 \u062e\u0631\u0648\u062c\u06cc \u0686\u0646\u062f worker \u0628\u0647 \u06cc\u06a9 \u062e\u0631\u0648\u062c\u06cc."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0627\u0644\u06af\u0648\u06cc Worker Pool \u0628\u0627 \u0645\u062d\u062f\u0648\u062f\u06cc\u062a \u0647\u0645\u0632\u0645\u0627\u0646\u06cc \u0648 cancel:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"type Job struct{ ID int }\n\ntype Result struct{ ID int; Err error }\n\nfunc worker(ctx context.Context, id int, jobs <-chan Job, results chan<- Result) {\n    for {\n        select {\n        case <-ctx.Done():\n            return\n        case j, ok := <-jobs:\n            if !ok { return }\n            // simulate work\n            err := doJob(ctx, j)\n            select {\n            case results <- Result{ID: j.ID, Err: err}:\n            case <-ctx.Done():\n                return\n            }\n        }\n    }\n}\n\nfunc runPool(ctx context.Context, n int, jobsList []Job) []Result {\n    jobs := make(chan Job)\n    results := make(chan Result)\n\n    var wg sync.WaitGroup\n    wg.Add(n)\n    for i := 0; i < n; i++ {\n        i := i\n        go func() { defer wg.Done(); worker(ctx, i, jobs, results) }()\n    }\n\n    go func() {\n        defer close(jobs)\n        for _, j := range jobsList {\n            select { case jobs <- j: case <-ctx.Done(): return }\n        }\n    }()\n\n    go func() { wg.Wait(); close(results) }()\n\n    var out []Result\n    for r := range results { out = append(out, r) }\n    return out\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u062a\u0631\u062a\u06cc\u0628 \u0646\u062a\u0627\u06cc\u062c \u0627\u06af\u0631 \u0645\u0647\u0645 \u0627\u0633\u062a\u060c \u06cc\u06a9 index \u0646\u06af\u0647\u200c\u062f\u0627\u0631 \u06cc\u0627 \u0627\u0632 \u0633\u0627\u062e\u062a\u0627\u0631\u0647\u0627\u06cc\u06cc \u0645\u062b\u0644 ",(0,s.jsx)(e.code,{children:"[]*Result"})," + sort \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0628\u0631\u0627\u06cc \xab\u062f\u0642\u06cc\u0642\u0627\u064b \u06cc\u06a9\u0628\u0627\u0631\xbb \u06cc\u0627 \xab\u062d\u062f\u0627\u0642\u0644 \u06cc\u06a9\u0628\u0627\u0631\xbb \u062a\u062d\u0648\u06cc\u0644\u060c semantics \u0631\u0627 \u0631\u0648\u0634\u0646 \u06a9\u0646 \u0648 idempotency \u0633\u0645\u062a \u0645\u0635\u0631\u0641\u200c\u06a9\u0646\u0646\u062f\u0647 \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-8-or-done-channel",children:"\ud83d\udeaa 8) or-done-channel"}),"\n",(0,s.jsx)(e.p,{children:"\u0648\u0642\u062a\u06cc \u0627\u0632 \u06cc\u06a9 channel \u0645\u06cc\u200c\u062e\u0648\u0627\u0646\u06cc \u0648\u0644\u06cc \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc \u0647\u0631 \u0644\u062d\u0638\u0647 \u0628\u062a\u0648\u0627\u0646\u06cc cancel \u06a9\u0646\u06cc \u062a\u0627 \u06af\u06cc\u0631 \u0646\u06a9\u0646\u06cc."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func OrDone[T any](done <-chan struct{}, in <-chan T) <-chan T {\n    out := make(chan T)\n    go func() {\n        defer close(out)\n        for {\n            select {\n            case <-done:\n                return\n            case v, ok := <-in:\n                if !ok { return }\n                select {\n                case out <- v:\n                case <-done:\n                    return\n                }\n            }\n        }\n    }()\n    return out\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u06a9\u0627\u0631\u0628\u0631\u062f:"})," \u062f\u0631 bridge/tee \u0648 \u0647\u0631\u062c\u0627\u06cc\u06cc \u06a9\u0647 \u062e\u0648\u0627\u0646\u062f\u0646 \u0628\u0644\u0627\u06a9\u200c\u06a9\u0646\u0646\u062f\u0647 \u0627\u0633\u062a."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-9-tee-channel-\u06a9\u067e\u06cc-\u062c\u0631\u06cc\u0627\u0646-\u0628\u0647-\u062f\u0648-\u062e\u0631\u0648\u062c\u06cc",children:"\ud83d\udd00 9) tee-channel (\u06a9\u067e\u06cc \u062c\u0631\u06cc\u0627\u0646 \u0628\u0647 \u062f\u0648 \u062e\u0631\u0648\u062c\u06cc)"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0645\u0633\u0626\u0644\u0647:"})," \u0647\u0631 \u0648\u0631\u0648\u062f\u06cc \u0628\u0627\u06cc\u062f \u0628\u0647 \u062f\u0648 \u0645\u0635\u0631\u0641\u200c\u06a9\u0646\u0646\u062f\u0647 \u0645\u0633\u062a\u0642\u0644 \u0628\u0631\u0648\u062f."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func Tee[T any](done <-chan struct{}, in <-chan T) (<-chan T, <-chan T) {\n    out1 := make(chan T)\n    out2 := make(chan T)\n\n    go func() {\n        defer close(out1); defer close(out2)\n        for v := range OrDone(done, in) {\n            var o1, o2 = out1, out2\n            var v1, v2 = v, v\n            for i := 0; i < 2; i++ {\n                select {\n                case o1 <- v1:\n                    o1 = nil // \u062c\u0644\u0648\u06af\u06cc\u0631\u06cc \u0627\u0632 \u0627\u0631\u0633\u0627\u0644 \u062f\u0648\u0628\u0627\u0631\u0647\n                case o2 <- v2:\n                    o2 = nil\n                case <-done:\n                    return\n                }\n            }\n        }\n    }()\n    return out1, out2\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a:"})," \u0627\u06af\u0631 \u06cc\u06a9\u06cc \u0627\u0632 \u062e\u0631\u0648\u062c\u06cc\u200c\u0647\u0627 \u06a9\u0646\u062f \u0628\u0627\u0634\u062f\u060c backpressure \u0627\u06cc\u062c\u0627\u062f \u0645\u06cc\u200c\u0634\u0648\u062f. \u0627\u06af\u0631 \u0646\u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc\u060c \u0628\u0627\u06cc\u062f \u0628\u0627\u0641\u0631 \u0648 \u0633\u06cc\u0627\u0633\u062a drop \u062a\u0639\u0631\u06cc\u0641 \u06a9\u0646\u06cc."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-10-bridge-channel-flatten-\u06a9\u0631\u062f\u0646-channel-of-channels",children:"\ud83c\udf09 10) bridge-channel (flatten \u06a9\u0631\u062f\u0646 channel-of-channels)"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0645\u0633\u0626\u0644\u0647:"})," \u06cc\u06a9 channel \u062f\u0627\u0631\u06cc \u06a9\u0647 \u062e\u0648\u062f\u0634 channel \u062a\u0648\u0644\u06cc\u062f \u0645\u06cc\u200c\u06a9\u0646\u062f (stream\u0647\u0627\u06cc \u0645\u062a\u0639\u062f\u062f). \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc \u06cc\u06a9 \u062e\u0631\u0648\u062c\u06cc \u06cc\u06a9\u067e\u0627\u0631\u0686\u0647 \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634\u06cc."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func Bridge[T any](done <-chan struct{}, chanStream <-chan (<-chan T)) <-chan T {\n    out := make(chan T)\n    go func() {\n        defer close(out)\n        for ch := range OrDone(done, chanStream) {\n            for v := range OrDone(done, ch) {\n                select {\n                case out <- v:\n                case <-done:\n                    return\n                }\n            }\n        }\n    }()\n    return out\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627\u06af\u0631 \u06cc\u06a9 \u0632\u06cc\u0631\u062c\u0631\u06cc\u0627\u0646 hang \u06a9\u0646\u062f\u060c ",(0,s.jsx)(e.code,{children:"OrDone"})," \u062c\u0644\u0648\u06cc leak \u0631\u0627 \u0645\u06cc\u200c\u06af\u06cc\u0631\u062f."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u0645\u06cc\u200c\u062a\u0648\u0627\u0646 \u0628\u0631\u0627\u06cc \u0647\u0631 \u0632\u06cc\u0631\u062c\u0631\u06cc\u0627\u0646 deadline \u062c\u062f\u0627\u06af\u0627\u0646\u0647 \u06af\u0630\u0627\u0634\u062a."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h1,{id:"-11-queuing",children:"\ud83d\udce5 11) Queuing"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u06af\u0632\u06cc\u0646\u0647\u200c\u0647\u0627:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u06a9\u0627\u0646\u0627\u0644 \u0628\u0627\u0641\u0631\u200c\u062f\u0627\u0631 \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 \u0635\u0641 bounded."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627Ring buffer \u0628\u0631\u0627\u06cc \u06a9\u0627\u0631\u0627\u06cc\u06cc \u0628\u06cc\u0634\u062a\u0631 \u0648 \u062d\u0630\u0641 realloc (\u0645\u062b\u0644\u0627\u064b ",(0,s.jsx)(e.code,{children:"container/ring"})," \u06cc\u0627 \u067e\u06cc\u0627\u062f\u0647\u200c\u0633\u0627\u0632\u06cc \u0634\u062e\u0635\u06cc)."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627Priority Queue \u0628\u0627 ",(0,s.jsx)(e.code,{children:"container/heap"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0627\u0644\u06af\u0648\u06cc bounded queue \u0628\u0627 \u0633\u06cc\u0627\u0633\u062a drop-new:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"type Task struct{ ID int }\n\ntype Queue struct{\n    ch chan Task\n}\n\nfunc NewQueue(n int) *Queue { return &Queue{ch: make(chan Task, n)} }\n\n// \u0627\u06af\u0631 \u0635\u0641 \u067e\u0631 \u0628\u0627\u0634\u062f\u060c \u062a\u0633\u06a9\u0650 \u062c\u062f\u06cc\u062f drop \u0645\u06cc\u200c\u0634\u0648\u062f\nfunc (q *Queue) EnqueueNonBlocking(t Task) bool {\n    select {\n    case q.ch <- t:\n        return true\n    default:\n        return false\n    }\n}\n\nfunc (q *Queue) Dequeue(ctx context.Context) (Task, bool) {\n    select {\n    case t, ok := <-q.ch:\n        return t, ok\n    case <-ctx.Done():\n        return Task{}, false\n    }\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u0633\u06cc\u0627\u0633\u062a\u200c\u0647\u0627:"})," drop-tail\u060c drop-head\u060c sampling\u060c \u06cc\u0627 blocking \u0628\u0627 timeout. \u0627\u0646\u062a\u062e\u0627\u0628 \u0633\u06cc\u0627\u0633\u062a \u0628\u0647 SLA/UX \u0628\u0633\u062a\u06af\u06cc \u062f\u0627\u0631\u062f."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0646\u06a9\u0627\u062a \u067e\u0631\u0648\u0688\u0627\u06a9\u0634\u0646:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"metric \u0637\u0648\u0644 \u0635\u0641 + \u0646\u0631\u062e drop."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"alert \u0648\u0642\u062a\u06cc \u0639\u0645\u0642 \u0635\u0641 \u0637\u0648\u0644\u0627\u0646\u06cc \u0634\u062f."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.h1,{id:"-12-\u067e\u06a9\u06cc\u062c-context",children:["\ud83e\uddf0 12) \u067e\u06a9\u06cc\u062c ",(0,s.jsx)(e.code,{children:"context"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0627\u0635\u0648\u0644 \u0637\u0644\u0627\u06cc\u06cc:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u0627",(0,s.jsx)(e.code,{children:"ctx"})," \u0627\u0648\u0644\u06cc\u0646 \u0622\u0631\u06af\u0648\u0645\u0627\u0646 \u062a\u0627\u0628\u0639."]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["-\u0627 ",(0,s.jsx)(e.code,{children:"context"})," \u0631\u0627 \u062f\u0631 struct \u0646\u06af\u0647 \u0646\u062f\u0627\u0631\u061b \u0639\u0628\u0648\u0631 \u0628\u062f\u0647."]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627",(0,s.jsx)(e.code,{children:"context.Background()"})," \u0641\u0642\u0637 \u062f\u0631 \u0644\u0627\u06cc\u0647\u200c\u06cc \u0628\u0648\u062a/\u0631\u06cc\u0634\u0647."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627nil \u0646\u062f\u0647\u061b \u0627\u06af\u0631 \u0646\u062f\u0627\u0631\u06cc ",(0,s.jsx)(e.code,{children:"context.TODO()"})," \u0628\u062f\u0647."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0628\u0631\u0627\u06cc timeout \u0627\u0632 ",(0,s.jsx)(e.code,{children:"WithTimeout"}),"/",(0,s.jsx)(e.code,{children:"WithDeadline"})," \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646\u061b \u0628\u0631\u0627\u06cc manual cancel \u0627\u0632 ",(0,s.jsx)(e.code,{children:"WithCancel"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627\u0632 ",(0,s.jsx)(e.code,{children:"WithValue"})," \u0641\u0642\u0637 \u0628\u0631\u0627\u06cc \u062f\u0627\u062f\u0647\u200c\u0647\u0627\u06cc request-scoped \u0633\u0628\u06a9 (trace-id \u0648 ...) \u0628\u0627 \u06a9\u0644\u06cc\u062f type-safe."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["\u0627\u0632 Go 1.20 \u0628\u0647 \u0628\u0639\u062f: ",(0,s.jsx)(e.code,{children:"context.WithCancelCause"})," \u0648 ",(0,s.jsx)(e.code,{children:"context.Cause(ctx)"})," \u0628\u0631\u0627\u06cc \u0639\u0644\u062a cancel."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u0645\u062b\u0627\u0644 cancel \u0622\u0628\u0634\u0627\u0631\u06cc \u0628\u0627 errgroup:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"func doAll(ctx context.Context) error {\n    g, ctx := errgroup.WithContext(ctx)\n\n    g.Go(func() error { return taskA(ctx) })\n    g.Go(func() error { return taskB(ctx) })\n\n    // \u0627\u06af\u0631 \u06cc\u06a9\u06cc fail \u0634\u0648\u062f\u060c ctx \u0628\u0631\u0627\u06cc \u0628\u0642\u06cc\u0647 cancel \u0645\u06cc\u200c\u0634\u0648\u062f\n    return g.Wait()\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"pattern \u0641\u0631\u0627\u06af\u06cc\u0631 \u062f\u0631 \u062d\u0644\u0642\u0647\u200c\u0647\u0627:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-go",children:"for {\n    select {\n    case <-ctx.Done():\n        return ctx.Err()\n    case msg := <-ch:\n        _ = handle(ctx, msg)\n    }\n}\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\u0646\u06a9\u0627\u062a-\u062a\u06a9\u0645\u06cc\u0644\u06cc-\u0648-best-practices",children:"\u0646\u06a9\u0627\u062a \u062a\u06a9\u0645\u06cc\u0644\u06cc \u0648 Best Practices"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Metrics \u0648 Tracing:"})," \u06a9\u0627\u0646\u06a9\u0627\u0631\u0646\u0633\u06cc \u0628\u062f\u0648\u0646 observability \u062f\u0631\u062f\u0633\u0631\u0633\u0627\u0632 \u0627\u0633\u062a. \u0628\u0631\u0627\u06cc \u0647\u0631 stage/worker\u060c latency/QPS/queue-depth \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634 (Prometheus + OpenTelemetry)."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Limits:"})," \u0647\u0645\u06cc\u0634\u0647 \u06cc\u06a9 \u06af\u0644\u0648\u06af\u0627\u0647 \u06a9\u0646\u062a\u0631\u0644\u200c\u0634\u062f\u0647 \u062f\u0627\u0634\u062a\u0647 \u0628\u0627\u0634 (semaphore/buffer) \u062a\u0627 \u0627\u0632 overload \u062c\u0644\u0648\u06af\u06cc\u0631\u06cc \u0634\u0648\u062f."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Testability:"})," \u0628\u0627 ",(0,s.jsx)(e.code,{children:"context.WithTimeout"})," \u062a\u0633\u062a\u200c\u0647\u0627 \u0631\u0627 fail-fast \u06a9\u0646\u061b \u0627\u0632 ",(0,s.jsx)(e.code,{children:"goleak.VerifyNone"})," \u0628\u0639\u062f \u0627\u0632 \u062a\u0633\u062a\u200c\u0647\u0627 \u0627\u0633\u062a\u0641\u0627\u062f\u0647 \u06a9\u0646."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"**T"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"5-concurrency-at-scale",children:"5. Concurrency at Scale"}),"\n",(0,s.jsx)(e.h2,{id:"6-goroutines-and-the-go-runtime",children:"6. Goroutines and the Go runtime"})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>t});var c=r(6540);const s={},i=c.createContext(s);function o(n){const e=c.useContext(i);return c.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),c.createElement(i.Provider,{value:e},n.children)}}}]);